# Supported File Formats

This page details the file specifications required for importing, configuring, and exporting models in PhLynx.

## Standard CellML Files

### Module File
A standard CellML file containing the mathematical definitions of a module.
* **Format:** `.cellml`
* **Creation Guide:** See [CellML Module Format Guide](./cellml-module-format).

### Units File
A CellML file defining the units used within your modules to ensure dimensional consistency.
* **Format:** `.cellml`
* **Creation Guide:** See [CellML Units Format Guide](./cellml-units-file).

---

## Parameter File

A CSV file used to categorize variables as *constants*, *global constants*, or *state variables*.

**Format Requirements:**
* **File Type:** `.csv`
* **Columns:** 4 (Required)

| Column | Description |
| :--- | :--- |
| **variable_name** | The specific name of the parameter. |
| **units** | Unit name (must match a definition in the Units file). |
| **value** | The numerical value of the parameter. |
| **data_reference** | Citation or source for the value. Typical format: `[Author][Date][FirstWord]`. |

**Naming Conventions:**
The `variable_name` determines the scope of the parameter:
* **Constants:** `[module_name]_[parameter_name]`
* **Global Constants:** `[parameter_name]`

> [!NOTE]
> Parameters not declared in this file are treated as standard variables. While all columns are required for the file to load, currently only `variable_name` is actively used by the logic.

**Example Parameter File:**
![Example parameter file](../assets/images/parameter-file.png){.align-center width="600px"}

---

## Workspace State

A JSON file generated by PhLynx that captures the complete state of the current session.
* **Format:** `.json`
* **Usage:** Can be imported to restore module positions, connections, and visual configurations.

---

## Circulatory Autogen Configuration Files

PhLynx generates specific configuration files required by the [Circulatory Autogen](https://physiomelinks.github.io/circulatory_autogen/) library. These files map the visual connections in the PhLynx workspace to the underlying mathematical structure required for simulation.

### 1. Module Configuration (`module_config.json`)

A JSON file defining the interface between CellML modules and the solver. It consists of three main sections for each module entry:

1.  **Main Specification:** Defines the module type, source file, and boundary condition type.
2.  **Ports:** Defines how the module connects to others (Input, Output, or General).
3.  **Variables:** Declares units and access types for all internal variables.

**Example Entry:**
![Example module configuration file](../assets/images/module-config.png){.align-center width="600px"}

**Key Properties:**

| Property | Description |
| :--- | :--- |
| `vessel_type` | Corresponds to the `vessel_type` in the vessel array. |
| `BC_type` | Corresponds to the `BC_type` in the vessel array (Module sub-type). |
| `module_file` | The filename of the source `.cellml` file. |
| `module_type` | The component name within the source `.cellml` file. |
| `entrance_ports` | Port definitions for when this module receives input (connected as an `out_vessel`). Maps internal variables (e.g., `v_in`) to the source module's variables. |
| `exit_ports` | Port definitions for when this module provides output (connected as an `inp_vessel`). |
| `general_ports` | Port definitions for non-directional connections. Contains `port_types` (matching name required for connection) and `variables`. |

> [!NOTE]
> To allow a port variable to couple with multiple modules simultaneously, you must include `"multi_port": "True"` within the port definition.

**Variable & Unit Definitions:**
The `variables_and_units` array defines properties for every variable in the module:
* `[0] Name`: Variable name in CellML.
* `[1] Unit`: Unit name (must match `units.cellml`).
* `[2] Access`: Usually "access" (allows simulation access) or "no_access" (optimizes memory).
* `[3] Type`: One of `constant`, `global_constant`, `variable`, or `boundary_condition`.

---

### 2. Vessel Array (`vessel_array.csv`)

A CSV file defining the network topology (connections) of the system. Each row represents a specific module instance in the model.

| Column | Description |
| :--- | :--- |
| **vessel_name** | The unique name assigned to the module instance (e.g., `soma_SN`). |
| **BC_type** | The module sub-type or boundary condition type. |
| **vessel_type** | The generic module type (refers to the source component in the Module List). |
| **inp_vessels** | Space-separated list of modules that connect *into* this module. |
| **out_vessels** | Space-separated list of modules that this module *outputs to*. |

> [!NOTE]
> **Optional Positioning:** You may include `x`, `y`, and `z` columns in this file to define the spatial position of nodes upon import.

**Example Vessel Array:**
![Example vessel array file](../assets/images/vessel-array.png){.align-center width="600px"}